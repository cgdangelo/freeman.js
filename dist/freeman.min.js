(function(){"use strict";var e,n,t,i,r,u,o,c,f;r=require("dgram"),n=require("binary-parser").Parser,o=require("ref"),f=null,e={PREFIX:"每每每每",REQUESTS:{A2S_INFO:{HEADER:"T",PAYLOAD:"Source Engine Query"}}},n.prototype.ztstring=function(e,n){return null==n&&(n={}),n.zeroTerminated=!0,this.string(e,n)},i=function(){return function(e){return f=r.createSocket("udp4"),f.on("error",function(e){throw f.close(),e}),f.on("message",e),f}}(this),t=function(n){return Buffer.concat([new Buffer(e.PREFIX,"binary"),new Buffer(e.REQUESTS[n].HEADER,"binary"),new Buffer(e.REQUESTS[n].PAYLOAD,"binary"),new Buffer("\x00","binary")])},c=function(e,n,t,r){return null==f&&(f=i(r)),f.send(t,0,t.length,n,e,function(e){if(null!=e)throw e})},u=function(e,i,r){var u,o,f;return f=(new n).endianess("little").uint8("mode").uint8("witnesses").uint8("duration"),o=(new n).int16le("port").ztstring("name"),u=(new n).endianess("little").array("prefix",{type:"uint8",length:4}).uint8("header").uint8("protocol_version").ztstring("name").ztstring("map").ztstring("folder").ztstring("game").int16("game_id").uint8("players").uint8("max_players").uint8("bots").uint8("server_type").uint8("environment").uint8("visibility").uint8("vac").choice("the_ship",{tag:function(){return-1!==[2400,2401,2402,2412].indexOf(this.game_id)?1:void 0},choices:{1:f},defaultChoice:function(){}}).ztstring("game_version").uint8("edf").choice("port",{tag:function(){return 128&this.edf?1:void 0},choices:{1:"int16le"},defaultChoice:function(){}}).choice("steam_id",{tag:function(){return 16&this.edf?1:void 0},choices:{1:(new n).buffer(null,{length:8})},defaultChoice:function(){}}).choice("source_tv",{tag:function(){return 64&this.edf?1:void 0},choices:{1:o},defaultChoice:function(){}}).choice("keywords",{tag:function(){return 32&this.edf?1:void 0},choices:{1:(new n).ztstring()},defaultChoice:function(){}}).choice("game_id64",{tag:function(){return 1&!!this.edf?1:void 0},choices:{1:(new n).buffer(null,{length:8})},defaultChoice:function(){}}),c(e,i,t("A2S_INFO"),function(e){var n;return n=u.parse(e),null!=n.steam_id&&Buffer.isBuffer(n.steam_id)&&(n.steam_id=n.steam_id.readUInt64LE()),null!=n.game_id64&&Buffer.isBuffer(n.game_id64)&&(n.game_id64=n.game_id64.readUInt64LE()),r(n)})},module.exports={info:u}}).call(this);